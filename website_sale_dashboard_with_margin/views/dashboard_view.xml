<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="dashboard_view_with_margin" model="ir.ui.view">
            <field name="name">Website Sale: Dashboard View With Margin</field>
            <field name="mode">primary</field>
            <field name="priority">1</field>
            <field name="model">sale.report</field>
            <field name="inherit_id" ref="website_sale_dashboard.sale_dashboard_view"/>
            <field name="arch" type="xml">
                <xpath expr="//formula[@name='total']" position='after'>
                    <aggregate name="total_margin" field="margin" domain="[['state', 'in', ['sale','done']]]" invisible="1"/>
                    <formula name="average_margin" string="Average Margin" value="record.total_margin / record.order_id_confirmed_orders" widget="monetary"/>
                </xpath>
            </field>
        </record>
    </data>
</odoo>

