<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="appointment_booked_mail_template" model="mail.template">
            <field name="name">Appointment Booked</field>
            <field name="model_id" ref="calendar.model_calendar_event"/>
            <field name="subject">Appointment Booked: ${object.appointment_type_id.name}</field>
            <field name="email_from">${(user.email_formatted or object.user_id.email_formatted) | safe}</field>
            <field name="body_html" type="html">
<div>
    % set colors = {'needsAction': 'grey', 'accepted': 'green', 'tentative': '#FFFF00', 'declined': 'red'}
    % set recurrent = object.recurrence_id and not ctx.get('calendar_template_ignore_recurrence')
    <p>
    Appointment booked for ${object.appointment_type_id.name} with ${object.partner_id.name}.
    </p>
        <div style="text-align: center; margin: 16px 0px 16px 0px;">
        <a href="/calendar/meeting/join?token=${object.access_token}"
            style="padding: 5px 10px; color: #FFFFFF; text-decoration: none; background-color: #875A7B; border: 1px solid #875A7B; border-radius: 3px">
            Join</a>
        <a href="/web?#id=${object.id}&amp;view_type=form&amp;model=calendar.event"
            style="padding: 5px 10px; color: #FFFFFF; text-decoration: none; background-color: #875A7B; border: 1px solid #875A7B; border-radius: 3px">
            View</a>
    </div>
    <table border="0" cellpadding="0" cellspacing="0"><tr>
            <td width="130px;">
                <div style="border-top-left-radius: 3px; border-top-right-radius: 3px; font-size: 12px; border-collapse: separate; text-align: center; font-weight: bold; color: #ffffff; min-height: 18px; background-color: #875A7B; border: 1px solid #875A7B;">
                    ${format_datetime(dt=object.start, tz=object.mail_tz if not object.allday else None, dt_format="EEEE", lang_code=object.env.lang)}
                </div>
                <div style="font-size: 48px; min-height: auto; font-weight: bold; text-align: center; color: #5F5F5F; background-color: #F8F8F8; border: 1px solid #875A7B;">
                    ${str(object.start.day)}
                </div>
                <div style='font-size: 12px; text-align: center; font-weight: bold; color: #ffffff; background-color: #875A7B;'>
                    ${format_datetime(dt=object.start, tz=object.mail_tz if not object.allday else None, dt_format="MMMM y", lang_code=object.env.lang)}
                </div>
                <div style="border-collapse: separate; color: #5F5F5F; text-align: center; font-size: 12px; border-bottom-right-radius: 3px; font-weight: bold; border: 1px solid #875A7B; border-bottom-left-radius: 3px;">
                    % if not object.allday
                        <div>
                            ${format_time(time=object.start, tz=object.mail_tz, time_format="short", lang_code=object.env.lang)}
                        </div>
                        % if object.mail_tz
                        <div style="font-size: 10px; font-weight: normal">
                            (${object.mail_tz})
                        </div>
                        % endif
                    %endif
                </div>
            </td>
            <td width="20px;"/>
            <td style="padding-top: 5px;">
                <p><strong>Details of the event</strong></p>
                <ul>
                    % if object.location:
                        <li>Location: ${object.location}
                            (<a target="_blank" href="http://maps.google.com/maps?oi=map&amp;q=${object.location}">View Map</a>)
                        </li>
                    % endif
                    % if recurrent:
                        <li>When: ${object.recurrence_id.name}</li>
                    % endif
                    % if not object.allday and object.duration
                        <li>Duration: ${('%dH%02d' % (object.duration,round(object.duration*60)%60))}</li>
                    % endif
                    % if object.description:
                        % set splitted_description = object.description_to_html_lines()
                        <li>Description:
                            <ul>
                                % for description_line in splitted_description:
                                <li>${description_line | safe}</li>
                                % endfor
                            </ul>
                        </li>
                    % endif
                    <li>Attendees
                    <ul>
                    % for attendee in object.attendee_ids:
                        <li>
                            <div style="display: inline-block; border-radius: 50%; width: 10px; height: 10px; background:${colors[attendee.state] or 'white'};"> </div>
                            % if attendee.common_name != object.common_name:
                                <span style="margin-left:5px">${attendee.common_name}</span>
                            % else:
                                <span style="margin-left:5px">You</span>
                            % endif
                        </li>
                    % endfor
                    </ul></li>
                    % if object.videocall_location:
                    <li>Join Video Call: <a href="${object.videocall_location}" target="_blank">${object.videocall_location}</a></li>
                    % endif
                </ul>
            </td>
    </tr></table>
</div>
            </field>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="auto_delete" eval="True"/>
        </record>

        <record id="appointment_canceled_mail_template" model="mail.template">
            <field name="name">Appointment Canceled</field>
            <field name="model_id" ref="calendar.model_calendar_event"/>
            <field name="subject">Appointment Canceled: ${object.appointment_type_id.name}</field>
            <field name="email_from">${(user.email_formatted or object.user_id.email_formatted) | safe}</field>
            <field name="body_html" type="html">
<div>
    % set colors = {'needsAction': 'grey', 'accepted': 'green', 'tentative': '#FFFF00', 'declined': 'red'}
    % set recurrent = object.recurrence_id and not ctx.get('calendar_template_ignore_recurrence')
    <p>
    The appointment for ${object.appointment_type_id.name} with ${object.partner_id.name} has been canceled.
    </p>
<table border="0" cellpadding="0" cellspacing="0"><tr>
            <td width="130px;">
                <div style="border-top-left-radius: 3px; border-top-right-radius: 3px; font-size: 12px; border-collapse: separate; text-align: center; font-weight: bold; color: #ffffff; min-height: 18px; background-color: #875A7B; border: 1px solid #875A7B;">
                    ${format_datetime(dt=object.start, tz=object.mail_tz if not object.allday else None, dt_format="EEEE", lang_code=object.env.lang)}
                </div>
                <div style="font-size: 48px; min-height: auto; font-weight: bold; text-align: center; color: #5F5F5F; background-color: #F8F8F8; border: 1px solid #875A7B;">
                    ${str(object.start.day)}
                </div>
                <div style='font-size: 12px; text-align: center; font-weight: bold; color: #ffffff; background-color: #875A7B;'>
                    ${format_datetime(dt=object.start, tz=object.mail_tz if not object.allday else None, dt_format="MMMM y", lang_code=object.env.lang)}
                </div>
                <div style="border-collapse: separate; color: #5F5F5F; text-align: center; font-size: 12px; border-bottom-right-radius: 3px; font-weight: bold; border: 1px solid #875A7B; border-bottom-left-radius: 3px;">
                    % if not object.allday
                        <div>
                            ${format_time(time=object.start, tz=object.mail_tz, time_format="short", lang_code=object.env.lang)}
                        </div>
                        % if object.mail_tz
                        <div style="font-size: 10px; font-weight: normal">
                            (${object.mail_tz})
                        </div>
                        % endif
                    %endif
                </div>
            </td>
            <td width="20px;"/>
            <td style="padding-top: 5px;">
                <del>
                    <p><strong>Details of the event</strong></p>
                    <ul>
                        % if object.location:
                            <li>Location: ${object.location}
                                (<a target="_blank" href="http://maps.google.com/maps?oi=map&amp;q=${object.location}">View Map</a>)
                            </li>
                        % endif
                        % if recurrent:
                            <li>When: ${object.recurrence_id.name}</li>
                        % endif
                        % if not object.allday and object.duration
                            <li>Duration: ${('%dH%02d' % (object.duration,round(object.duration*60)%60))}</li>
                        % endif
                        % if object.description:
                            % set splitted_description = object.description_to_html_lines()
                            <li>Description:
                                <ul>
                                    % for description_line in splitted_description:
                                    <li>${description_line | safe}</li>
                                    % endfor
                                </ul>
                            </li>
                        % endif
                        <li>Attendees
                        <ul>
                        % for attendee in object.attendee_ids:
                            <li>
                                <div style="display: inline-block; border-radius: 50%; width: 10px; height: 10px; background:${colors[attendee.state] or 'white'};"> </div>
                                % if attendee.common_name != object.common_name:
                                    <span style="margin-left:5px">${attendee.common_name}</span>
                                % else:
                                    <span style="margin-left:5px">You</span>
                                % endif
                            </li>
                        % endfor
                        </ul></li>
                        % if object.videocall_location:
                        <li>Join Video Call: <a href="${object.videocall_location}" target="_blank">${object.videocall_location}</a></li>
                        % endif
                    </ul>
                </del>
            </td>
    </tr></table>
</div>
            </field>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="auto_delete" eval="True"/>
        </record>
    </data>
</odoo>
