<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="event_report_template_foldable_badge_inherit_barcode" inherit_id="event.event_report_template_foldable_badge" priority="1">
        <xpath expr="//div[hasclass('o_event_foldable_badge_barcode_id_top')]" position="replace">
            <div class="fs-4 mt-2">
                <span t-out="attendee.barcode if attendee else '12345678901234567890'"/>
            </div>
        </xpath>
        <xpath expr="//div[hasclass('o_event_foldable_badge_barcode_id_bottom')]" position="replace">
            <div class="fs-4 mt-2">
                <span t-out="attendee.barcode if attendee else '12345678901234567890'"/>
            </div>
        </xpath>
        <xpath expr="//div[hasclass('o_event_foldable_badge_barcode_container_top')]" position="inside">
            <img t-attf-src="/report/barcode/QR/{{attendee.barcode if attendee else '12345678901234567890'}}?&amp;width=174&amp;height=174&amp;quiet=0" alt="QR Code"/>
        </xpath>
        <xpath expr="//div[hasclass('o_event_foldable_badge_barcode_container_bottom')]" position="inside">
            <img t-attf-src="/report/barcode/QR/{{attendee.barcode if attendee else '12345678901234567890'}}?&amp;width=174&amp;height=174&amp;quiet=0" alt="QR Code"/>
        </xpath>
    </template>

    <template id="event_report_template_badge_card_inherit_barcode" inherit_id="event.event_report_template_badge_card" priority="1">
        <xpath expr="//span[hasclass('o_event_badge_barcode_container')]" position="inside">
            <img t-att-class="'mb-2' + (' ms-5' if event.organizer_id.image_256 else '')" t-attf-src="/report/barcode/QR/{{attendee.barcode if attendee else '12345678901234567890'}}?&amp;width=116&amp;height=116&amp;quiet=0" alt="QR Code"/>
        </xpath>
    </template>

    <template id="event_report_template_full_page_ticket_inherit_barcode" inherit_id="event.event_report_template_full_page_ticket">
        <xpath expr="//div[hasclass('o_event_full_page_ticket_barcode_container')]" position="inside">
            <div class="pb-3"><img t-attf-src="/report/barcode/QR/{{attendee.barcode if attendee else '12345678901234567890'}}?&amp;width=116&amp;height=116&amp;quiet=0" alt="QR Code"/></div>
            <img class="o_event_barcode" t-attf-src="/report/barcode/?barcode_type=Code128&amp;value={{attendee.barcode if attendee else '12345678901234567890'}}&amp;width=168&amp;height=84&amp;humanreadable=1&amp;quiet=0" alt="Barcode"/>
        </xpath>
    </template>

    <template id="attendee_list">
        <h1>Attendee list</h1>
        <div class="row">
            <div class="col-7">
                <div t-out="event.name"/>
            </div>
            <div class="col-5">
                <span t-out="event.date_begin"/>
                <i class="fa fa-arrow-right"/>
                <span t-out="event.date_end"/>
            </div>
        </div>
        <table class="table mt-3" style="page-break-after:always;">
            <thead>
                <tr class="text-start">
                    <th>Name</th>
                    <th>Company</th>
                    <th>Ticket type</th>
                    <th>Phone number</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr t-foreach="attendees" t-as="attendee">
                    <td><t t-out="attendee.name"/></td>
                    <td><t t-out="attendee.company_name"/></td>
                    <td><t t-out="attendee.event_ticket_id.name"/></td>
                    <td><t t-out="attendee.phone"/></td>
                    <td class="text-center">
                        <t t-if="attendee.barcode">
                            <img t-attf-src="/report/barcode/QR/{{ attendee.barcode }}?&amp;width=87&amp;height=87&amp;quiet=0" alt="QR Code"/>
                        </t>
                    </td>
                </tr>
            </tbody>
        </table>
    </template>

    <template id="event_registration_attendee_list">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <t t-foreach="docs.grouped('event_id').items()" t-as="group">
                    <t t-call="event_barcode.attendee_list">
                        <t t-set="event" t-value="group[0].with_context(tz=group[0].date_tz)"/>
                        <t t-set="attendees" t-value="group[1]"/>
                    </t>
                </t>
            </t>
        </t>
    </template>

    <template id="event_event_attendee_list">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <t t-foreach="docs" t-as="event">
                    <t t-call="event_barcode.attendee_list">
                        <t t-set="event" t-value="event.with_context(tz=event.date_tz)"/>
                        <t t-set="attendees" t-value="event.registration_ids"/>
                    </t>
                </t>
            </t>
        </t>
    </template>
</odoo>
