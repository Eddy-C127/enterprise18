<?xml version="1.0"?>
<odoo>

    <record id="calendar_event_view_form" model="ir.ui.view">
        <field name="name">calendar.event.view.form.inherit.appointment</field>
        <field name="model">calendar.event</field>
        <field name="inherit_id" ref="calendar.view_calendar_event_form"/>
        <field name="arch" type="xml">
            <field name="categ_ids" position="after">
                <field name="appointment_type_id"/>
                <field name="appointment_resource_id"
                       attrs="{'invisible': ['|', ('appointment_type_id', '=', False), ('appointment_resource_id', '=', False)]}"
                       domain="[('appointment_type_ids', 'in', appointment_type_id)]"/>
                <field name="resource_total_capacity_reserved"
                       attrs="{'invisible': [('appointment_resource_id', '=', False)]}"/>
            </field>
            <xpath expr="//page[@name='page_details']" position="after">
                <page name="page_appointment" string="Appointment Details"
                    attrs="{'invisible': [('appointment_type_id', '=', False)]}">
                    <field name="booking_line_ids" attrs="{'invisible': [('active', '=', False)]}">
                        <tree editable="bottom">
                            <field name="appointment_type_id" invisible="1"/>
                            <field name="appointment_resource_id" domain="[('appointment_type_ids', 'in', appointment_type_id)]"/>
                            <field name="capacity_reserved" sum="Total Capacity Reserved"/>
                            <field name="capacity_used" optional="hide" sum="Total Capacity Used"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <record id="calendar_event_view_tree" model="ir.ui.view">
        <field name="name">calendar.event.view.tree.inherit.appointment</field>
        <field name="model">calendar.event</field>
        <field name="inherit_id" ref="calendar.view_calendar_event_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='duration']" position="after">
                <field name="appointment_type_id" groups="base.group_no_one"/>
                <field name="appointment_resource_ids" widget="many2many_tags" groups="base.group_no_one"/>
            </xpath>
        </field>
    </record>

    <record id="calendar_event_view_search" model="ir.ui.view">
        <field name="name">calendar.event.view.search.inherit.appointment</field>
        <field name="model">calendar.event</field>
        <field name="inherit_id" ref="calendar.view_calendar_event_search"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='inactive']" position="before">
                <separator/>
                <filter string="Online Appointments" domain="[('appointment_type_id', '!=', False)]" name="online"/>
                <separator/>
            </xpath>
            <xpath expr="//filter[@name='responsible']" position="after">
                <field name="appointment_type_id"/>
                <filter string="Appointment Type" name="group_by_appointment_type_id" context="{'group_by': 'appointment_type_id'}"/>
            </xpath>
        </field>
    </record>

    <record id="calendar_event_view_tree_booking" model="ir.ui.view">
        <field name="name">calendar.event.view.tree.booking</field>
        <field name="model">calendar.event</field>
        <field name="arch" type="xml">
            <tree create="0" sample="1" decoration-danger="not active">
                <field name="active" invisible="1"/>
                <field name="name" string="Subject"/>
                <field name="appointment_type_id"/>
                <field name="attendee_ids" string="Booked by" widget="many2many_tags"/>
                <field name="appointment_resource_ids" widget="many2many_tags"/>
                <field name="start"/>
                <field name="stop"/>
                <field name="resource_total_capacity_reserved" sum="Total Capacity Reserved"/>
                <field name="resource_total_capacity_used" optional="show" sum="Total Capacity Used"/>
            </tree>
        </field>
    </record>

    <record id="calendar_event_action_view_bookings" model="ir.actions.act_window">
        <field name="name">Resource Bookings</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">calendar.event</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="calendar_event_view_tree_booking"/>
        <field name="domain">[('booking_line_ids', '!=', False)]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No Appointment Booking Found
            </p>
        </field>
    </record>

    <!-- Calendar Reporting -->
    <record id="calendar_event_view_graph" model="ir.ui.view">
        <field name="name">calendar.event.view.graph</field>
        <field name="model">calendar.event</field>
        <field name="arch" type="xml">
            <graph string="Appointments" type="line" sample="1">
                <field name="start"/>
                <field name="res_id" invisible="1"/>
            </graph>
        </field>
    </record>

    <record id="calendar_event_view_pivot" model="ir.ui.view">
        <field name="name">calendar.event.view.pivot</field>
        <field name="model">calendar.event</field>
        <field name="arch" type="xml">
            <pivot string="Appointments" display_quantity="1" sample="1">
                <field name="start" type="row"/>
                <field name="categ_ids" type="row"/>
                <field name="name" type="row"/>
                <field name="user_id" type="col"/>
            </pivot>
        </field>
    </record>

    <record id="calendar_event_action_report" model="ir.actions.act_window">
        <field name="name">All Appointments</field>
        <field name="res_model">calendar.event</field>
        <field name="view_mode">graph,pivot,calendar,tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No data yet!
            </p><p>
                Schedule appointments to get statistics
            </p>
        </field>
    </record>

    <record id="calendar_event_action_reporting" model="ir.actions.act_window">
        <field name="name">Online Appointments</field>
        <field name="res_model">calendar.event</field>
        <field name="view_mode">pivot,graph,calendar,tree,form</field>
        <field name="context">{'search_default_online': True}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No data yet!
            </p><p>
                Schedule appointments to get statistics
            </p>
        </field>
    </record>

</odoo>
