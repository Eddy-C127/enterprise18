/////////   MIXINS   /////////

// -------  Provide room for the caret -------
.o-list-view-sortable-caret-padding(@base: @table-cell-padding, @ratio: 1) {
    > thead > tr > th.o_column_sortable:not(:empty) {
        padding-right: ceil(@base * @ratio) + 5px;

        // Extra room when needed
        &:last-child {
            padding-right: ceil(@base * @ratio) + 5px + @odoo-horizontal-padding;
        }
    }
}

// -------   Define paddings independently for each table component -------
.o-list-view-full-width-padding(@base: @table-cell-padding, @ratio: 1) {
    > thead > tr > th:not(:empty),
    > tfoot > tr > td:not(:empty) {
        padding: (ceil(@base * @ratio) + 4px) ceil(@base * @ratio);
    }

    > tbody > tr:not(.o_list_view_grouped) > td {
        padding: floor(@base * @ratio*0.9);
    }

    > tbody > tr.o_group_header {
        > th, > td {
            padding-top: floor(@table-condensed-cell-padding*0.2);
            padding-bottom: floor(@table-condensed-cell-padding*0.2);
        }
    }

    .o-list-view-sortable-caret-padding(@base, @ratio);

    // -------  Make full-width tables to fit odoo layout -------
    > thead > tr > th,
    > tbody > tr > td,
    > tbody > tr > th,
    > tfoot > tr > td {
        &:first-child {
            padding-left: @odoo-horizontal-padding;
        }

        &:last-child {
            padding-right: @odoo-horizontal-padding;
        }

        &.o_list_record_selector {
            // Checkbox doesn't need an huge padding-right in any case ...
            padding-right: 5px;

            // ... and if NOT :first-child, they don't need an huge padding-left neither
            &:not(:first-child) {
                padding-left: 5px;
            }
        }
    }
}


// /////////////////////   Full-Width List views //////////////////////
// Define full-width tables padding. Increase padding on large screens,
// but not if tables has groups.
// -------------------------------------------------------------------
.o_view_manager_content > div > div > .o_list_view.table {
    .o-list-view-full-width-padding(@ratio: 2.5);

    &.table-condensed {
        .o-list-view-full-width-padding(@base: @table-condensed-cell-padding, @ratio: 2);
    }

    &:not(.o_list_view_grouped) {
        @media screen and (min-width: @screen-lg-min) {
            .o-list-view-full-width-padding(@ratio: 3);

            &.table-condensed {
                .o-list-view-full-width-padding(@base: @table-condensed-cell-padding, @ratio: 2.5);
            }
        }
    }
}

// /////////////////////   Common style     /////////////////////
// For '.o_list_view' elements too (commonly used in form views)
// --------------------------------------------------------------
.o_list_view {
    border-collapse: initial;
    .o-list-view-sortable-caret-padding();

    // -------  Force empty cells' padding... -------
    > thead > tr > th,
    > tbody > tr > td,
    > tbody > tr > th,
    > tfoot > tr > td {
        &:empty {
            padding: 0!important;

            &:after {
                // ... end hide caret icon
                display: none;
            }
        }
    }

    // -------  Increase thead and tfoot vertical padding -------
    > thead > tr > th,
    > tfoot > tr > td {
        padding-top: @table-cell-padding + 3px;
        padding-bottom: @table-cell-padding + 3px;
    }

    &.table-condensed {
        > thead > tr > th,
        > tfoot > tr > td {
            padding-top: @table-condensed-cell-padding + 3px;
            padding-bottom: @table-condensed-cell-padding + 3px;
        }
    }

    // -------  Style thead -------
    thead {
        background-color: white;
        border: none;

        > tr:first-child > th {
            border: none;

            // -------  Sortable columns -------
            &.o_column_sortable {
                position: relative;

                &:after {
                    .o-position-absolute(@right: 3px);
                    content: "\f0d8";
                    opacity: 0;
                }

                &:last-child:after {
                    right: @odoo-horizontal-padding;
                }

                &.o-sort-up {
                    cursor:s-resize;

                    &:after {
                        content: "\f0d8";
                    }
                }

                &.o-sort-down {
                    cursor:n-resize;

                    &:after {
                        content: "\f0d7";
                    }
                }

                &:hover:after {
                    opacity: 0.3;
                }

                &.o-sort-up, &.o-sort-down {
                    color: @headings-color;

                    &:after {
                        opacity: 1;
                    }
                }
            }
        }
    }

    // -------  Decrease table's inner content "visual depth" -------
    tbody:first-of-type > tr:first-child:not(.o_group_header) {
        box-shadow: inset 0px 5px 10px -4px fade(black, 10%);
    }

    tfoot {
        border-top: none;
    }

    // -------  Force progress bars to respect table's layout -------
    .o_progressbar_cell {
        .o_progressbar {
            display: table-row;

            > div {
                width: 100%;
                display: table-cell;
            }

            .o_progressbar_value {
                width: 45px;
                min-width: 45px;
            }
        }
    }

    // -------   Grouped list views -------
    &.o_list_view_grouped {
        > tbody > tr.o_group_header {
            background-color: @gray-lighter;
            box-shadow: inset 0 2px 0 #ffffff;

            &.o_group_has_content {
                .o-hover-text-color(@text-muted, @brand-primary);

                &.o_group_open {
                    font-weight: bold;
                    .o-hover-text-color(@headings-color, @brand-primary);
                }
            }
        }

        // Decrease grouped content "visual depth"
        > tbody + tbody > tr:first-child:not(.o_group_header) {
            box-shadow: inset 0px 5px 10px -4px fade(black, 10%);
        }

        // Disable striped design for grouped content
        &.table-striped > tbody + tbody > tr:not(.o_group_header):nth-of-type(odd) {
            background-color: @table-bg;
        }
    }

    //--------------------------------------------------------------------------
    // Editable
    //--------------------------------------------------------------------------
    .o_data_row.o_selected_row > .o_data_cell:not(.o_readonly_modifier) {
        > *:last-child {
            border-right: 1px solid #cccccc;
        }
    }
}
