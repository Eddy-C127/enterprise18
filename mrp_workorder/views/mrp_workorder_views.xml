<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="mrp_workorder_view_form_tablet" model="ir.ui.view">
        <field name="name">mrp.workorder.view.form.tablet</field>
        <field name="model">mrp.workorder</field>
        <field name="arch" type="xml">
            <form string="Production Workcenter" create="0" delete="0">
                <field name="is_user_working" invisible="1"/>
                <field name="production_state" invisible="1"/>
                <header>
                    <button string="Finish Order" name="button_finish" type="object"
                        attrs="{'invisible': ['|',('state', '!=', 'progress'), ('qty_produced', '=', 0)]}" class="btn-info"/>
                    <button string="Start Working" name="button_start" type="object"
                        attrs="{'invisible': [('state', '!=', 'pending')]}"/>
                    <button string="Start Working" name="button_start" type="object"
                        attrs="{'invisible': [('state', '!=', 'ready')]}" class="btn-success"/>
                    <button name="record_production" string="Done" type="object"
                        class="btn-success" attrs="{'invisible': ['|', '|', ('state', '!=', 'progress'), ('is_user_working', '=', False)]}"/>
                    <button string="Pause" name="button_pending" type="object" class="btn-warning"
                            attrs="{'invisible': ['|', ('state', 'in', ('done', 'pending', 'ready')), ('is_user_working', '=', False)]}">
                    </button>
                    <button string="Blocked" name="%(mrp.act_mrp_block_workcenter_wo)d" type="action"
                        class="btn-danger" attrs="{'invisible': ['|', ('state', 'in', ('done', 'pending', 'ready')), ('is_user_working', '=', False)]}"/>
                    <button string="Continue Production" name="button_start" type="object"
                        class="btn-warning" attrs="{'invisible': ['|', ('is_user_working', '=', True), ('state', 'in', ('done', 'pending', 'ready'))]}"/>
                    <button string="Continue Production" name="button_start" type="object"
                        attrs="{'invisible': ['|', ('state', '!=', 'done'), ('production_state', '=', 'done')]}"/>
                    <button string="Scrap" name="button_scrap" type="object"
                        attrs="{'invisible': [('state', 'in', ('confirmed', 'cancel'))]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="pending,ready,progress,done"/>
                </header>
                <group>
                    <group>
                        <field name="product_id" string="To Produce"/>
                        <label for="qty_produced" string="Quantity Produced"/>
                        <div class="o_row">
                            <field name="qty_produced"/> /
                            <field name="qty_production"/>
                            <field name="product_uom_id" widget="selection"/>
                            <field name="production_availability" nolabel="1" widget="bullet_state" options="{'classes': {'assigned': 'success', 'waiting': 'danger'}}" attrs="{'invisible': [('state', '=', 'done')]}"/>
                        </div>
                    </group>
                    <div class="alert alert-warning alert-dismissible text-center" role="alert" attrs="{'invisible': [('production_messages', '=', False)]}">
                        <a href="#" class="close" data-dismiss="alert" aria-label="close">x</a>
                        <field name="production_messages" style="height: 50px;"/>
                    </div>
                </group>
                <notebook>
                    <page string="Work Instruction" attrs="{'invisible': [('worksheet', '=', False)]}">
                        <field name="worksheet" widget="image"/>
                    </page>
                    <page string="Current Production">
                        <group>
                            <group>
                                <field name="qty_producing" string="Current Qty"/>
                                <field name="final_lot_id" context="{'default_product_id': product_id}"/>
                            </group>
                            <group>
                                <label for="delay"/>
                                <button style="pointer-events: none;" class="oe_inline label label-default">
                                    <field name="duration" widget="mrp_time_counter"/>
                                </button>
                            </group>
                        </group>
                        <field name="move_lot_ids" domain="[('done', '=', False)]" attrs="{'invisible': [('move_lot_ids', '=', [])]}">
                            <tree editable="bottom">
                                <field name="product_id"/>
                                <field name="quantity"/>
                                <field name="lot_id" context="{'default_product_id': product_id}"/>
                            </tree>
                        </field>
                    </page>
                </notebook>
            </form>
        </field>
    </record>

    <record model="ir.actions.act_window" id="mrp_workorder_action_tablet">
        <field name="name">Work Orders</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">mrp.workorder</field>
        <field name="view_type">form</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="view_ids" eval="[(5, 0, 0),
            (0, 0, {'view_mode': 'kanban', 'view_id': ref('mrp.workcenter_line_kanban')}),
            (0, 0, {'view_mode': 'tree', 'view_id': ref('mrp.mrp_production_workcenter_tree_view_inherit')}),
            (0, 0, {'view_mode': 'form', 'view_id': ref('mrp_workorder_view_form_tablet')})]"/>
        <field name="target">fullscreen</field>
        <field name="domain">[('state', 'not in', ['done', 'cancel', 'pending']), ('workcenter_id','=',active_id)]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Click to start a new work order.
            </p><p>
                Work Orders is the list of operations to be performed for each
                manufacturing order. Once you start the first work order of a
                manufacturing order, the manufacturing order is automatically
                marked as started. Once you finish the latest operation of a
                manufacturing order, the MO is automatically done and the related
                products are produced.
            </p>
        </field>
    </record>
</odoo>
