<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="pos_preparation_display.Order" owl="1">
        <section
            class="o_pdis_order_card position-relative w-100 mx-auto mb-auto rounded bg-white"
            t-att-class="{ 'o_pdis_stage--animation': this.props.order.changeStageTimeout }"
            t-att-style="'border-top: 13px solid '+ this.headerColor">
            <div
                class="o_pdis_order w-100 bg-200 p-1"
                t-on-click="() => this.preparationDisplay.changeOrderStage(this.props.order, true)">
                <div class="o_pdis_customer-info d-flex justify-content-between align-items-center px-1">
                    <div t-esc="this.stage.name" class="o_pdis_stage badge rounded" t-att-style="`background-color: ${this.stage.color}80 !important;`" />
                </div>
                <div class="o_pdis_order-info  d-flex flex-wrap justify-content-between align-items-center">
                    <div class="o_pdis_responsible px-1 py-2 text-truncate">
                        <i class="fa fa-user-circle-o pe-2" aria-hidden="true"></i>
                        <span t-esc="this.props.order.responsible"/>
                    </div>
                    <div class="o_pdis_alert-timer px-1"
                        t-on-click.stop="doneOrder">
                        <div class="rounded"
                            t-att-class="{ 'o_pdis_is_alert bg-danger text-white': this.isAlert, 'o_pdis_archive-order cursor-pointer': this.preparationDisplay.lastStage.id === this.props.order.stageId }">
                            <div t-if="this.preparationDisplay.lastStage.id !== this.props.order.stageId" class="px-2 py-1">
                                <i class="fa fa-clock-o pe-2" aria-hidden="true"></i>
                                <span t-esc="this.state.duration" />'
                            </div>
                            <div t-else="" class="o_pdis_archive-button btn btn-danger px-2 py-1 rounded">
                                <i class="fa fa-archive pe-2" aria-hidden="true"></i>
                                <span>Archive</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="o_pdis_orderline w-100 overflow-auto" t-ref="orderlines-container" t-on-scroll="() => this.productBubbleHighlight()">
                <t t-foreach="this.props.order.orderlines" t-as="orderline" t-key="orderline.id">
                    <t t-if="this.preparationDisplay.checkOrderlineVisibility(orderline)">
                        <Orderline orderline="orderline"/>
                    </t>
                </t>
                <div class="product-down-bubble position-absolute bottom-0 start-50 translate-middle d-flex align-items-center justify-content-center badge rounded-pill py-2 px-3 text-bg-dark bg-opacity-75 small " t-if="this.state.productHighlighted.length">
                    <t t-if="this.state.productHighlighted.length === 1">
                        <t t-esc="this.state.productHighlighted[0]" />
                    </t>
                    <t t-else="">
                        <t t-esc="this.state.productHighlighted.length" /> products
                    </t>
                    <i class="ms-2 fa fa-arrow-down" aria-hidden="true"></i>
                </div>
            </div>
        </section>
    </t>
</templates>
