<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-extend="PaymentScreen-Paymentlines">
       <t t-jquery='.delete-button' t-operation='replace'>
            <t t-if="line &amp;&amp; line.payment_status &amp;&amp; ['done'].includes(line.payment_status)">
                <td/>
            </t>
            <t t-else=''>
                <td class='delete-button' t-att-data-cid='line.cid' aria-label="Delete" title="Delete">
                    <i class='fa fa-times-circle'/> 
                </td>
            </t>
        </t>
        <t t-jquery='.col-tendered.edit' t-operation='replace'>
            <t t-if="line &amp;&amp; line.payment_status &amp;&amp; ['done', 'waitingCard', 'waiting'].includes(line.payment_status)">
                <td class='col-tendered'>
                    <t t-esc='widget.inputbuffer' />
                </td>
            </t>
            <t t-else="">
                <td class='col-tendered edit'>
                    <t t-esc='widget.inputbuffer' />
                </td>
            </t>
        </t>
        <t t-jquery='.paymentline' t-operation='append'>
            <t t-if="line &amp;&amp; line.get_amount() != 0 &amp;&amp; line.payment_status">
                <tr class="send_request paymentline electronic_payment"/>
                <tr class="paymentline electronic_payment">
                    <t t-if="line.payment_status=='pending'">
                        <td colspan="3">
                            Payment request pending
                        </td>
                        <td colspan="2" class='button send_payment_request highlight' title="Send Payment Request">
                            Send
                        </td>
                    </t>
                    <t t-if="line.payment_status=='retry'">
                        <td colspan="3">
                            Retry Electronic payment
                        </td>
                        <td colspan="2" class='button send_payment_request highlight' title="Send Payment Request">
                            Retry
                        </td>
                    </t>
                    <t t-if="line.payment_status=='force_done'">
                        <td colspan="3">
                            Connection error
                        </td>
                        <td colspan="2" class='button send_force_done' title="Force Done">
                            Force done
                        </td>
                    </t>
                    <t t-elif="line.payment_status=='waitingCard'">
                        <td colspan="3">
                            Waiting for card
                        </td>
                        <td colspan="2" class='button send_payment_cancel' title="Cancel Payment Request">
                            Cancel
                        </td>
                    </t>
                    <t t-elif="['waiting', 'waitingCancel'].includes(line.payment_status)">
                        <td colspan="3">
                            Request send to terminal
                        </td>
                        <td colspan="2">
                            <i class='fa fa-spinner fa-spin' role='img'/>
                        </td>
                    </t>
                    <t t-elif="['done'].includes(line.payment_status)">
                        <td colspan="4">
                            Payment Successful
                        </td>
                    </t>
                </tr>
            </t>
        </t>
    </t>

    <t t-extend="XmlReceipt">
        <t t-jquery='.after-footer' t-operation='append'>
            <t t-foreach='paymentlines' t-as='line'>
                <t t-if='line.ticket'>
                    <br />
                    <div font='b'>
                        <t t-raw='line.ticket'/>
                    </div>
                </t>
            </t>
        </t>
    </t>

    <t t-extend="PosTicket">
        <t t-jquery='.pos-sale-ticket' t-operation='append'>
            <t t-foreach='paymentlines' t-as='line'>
                <t t-if='line.ticket'>
                    <br /> <hr class='ticket_cut'/> <br />
                    <div class='terminal_ticket'>
                        <t t-raw='line.ticket'/>
                    </div>
                </t>
            </t>
        </t>
    </t>

</templates>
