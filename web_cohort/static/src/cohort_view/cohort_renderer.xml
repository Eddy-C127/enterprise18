<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="web_cohort.CohortRenderer" owl="1">
        <div class="o_cohort_renderer">
            <t t-if="props.hasData">
                <t t-foreach="props.data" t-as="data" t-key="data_index">
                    <div t-if="data.title" class="table-responsive">
                        <table class="table text-center mb0">
                            <thead>
                                <tr>
                                    <th colspan="16">
                                        <t t-esc="data.title" />
                                    </th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                    <div t-if="data.rows.length" class="table-responsive">
                        <table class="table text-center mb0" t-att-class="{ o_sample_data_disabled: props.metaData.useSampleModel }">
                            <thead>
                                <tr>
                                    <th rowspan="2">
                                        <t t-esc="props.metaData.dateStartString" />
                                    </th>
                                    <th rowspan="2">
                                        <t t-esc="props.metaData.measures[props.metaData.measure].string"/>
                                    </th>
                                    <th colspan="16">
                                        <t t-esc="props.metaData.dateStopString" /> - By <t t-esc="props.metaData.intervals[props.metaData.interval]" />
                                    </th>
                                </tr>
                                <tr>
                                    <th t-foreach="range(data.rows[0].columns.length)" t-as="intervalNumber" t-key="intervalNumber">
                                        <t t-if="props.metaData.timeline === 'backward'">
                                            <t t-esc="intervalNumber - (data.rows[0].columns.length - 1)"/>
                                        </t>
                                        <t t-else="">
                                            +<t t-esc="intervalNumber"/>
                                        </t>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="data.rows" t-as="row" t-key="row.date"
                                    class="o_cohort_row_clickable"
                                    t-on-click="trigger('open-view', row)"
                                >
                                    <td class="o_cohort_value">
                                        <t t-esc="row.date" />
                                    </td>
                                    <td class="o_cohort_value">
                                        <t t-esc="formatFloat(row.value)" />
                                    </td>
                                    <td t-foreach="row.columns" t-as="col" t-key="col.period">
                                        <t t-if="col.percentage !== ''">
                                            <t t-set="count" t-value="mode === 'churn' ? (col.churn_value === '-' ? '' : col.churn_value) : (col.value === '-' ? '' : col.value)" />
                                            <t t-set="measure" t-value="props.metaData.measures[props.metaData.measure].string" />
                                            <div class="o_cohort_highlight"
                                                t-attf-title="Periode: {{col.period}}&#10;{{measure}}: {{count}}"
                                                t-attf-style="background-color: rgba(0, 160, 157, {{col.percentage/100.0}}); color: {{col.percentage gt 50 and '#FFFFFF' or 'inherit'}}"
                                                t-att-class="{o_cohort_value: col.value !== '-'}"
                                            >
                                                <t t-esc="formatPercentage(col.percentage / 100.0)"/>
                                            </div>
                                        </t>
                                    </td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td>Average</td>
                                    <td>
                                        <t t-esc="formatFloat(data.avg.avg_value)"/>
                                    </td>
                                    <td t-foreach="data.avg.columns_avg" t-as="col" t-key="col.period">
                                        <t t-if="data.avg.columns_avg[col]['count']">
                                            <t t-esc="formatPercentage(data.avg.columns_avg[col]['percentage'] / (data.avg.columns_avg[col]['count'] * 100.0))" />
                                        </t>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                    <div t-if="props.data.length > 1 &amp;&amp; !data.rows.length"
                        class="o_cohort_no_data text-center"
                    >
                        No data available.
                    </div>
                    <br/>
                </t>
            </t>
            <t t-set="displayNoContent" t-value="
                props.metaData.info.noContentHelp !== false and (
                    !props.hasData or props.metaData.useSampleModel
                )"
            />
            <t t-if="displayNoContent">
                <t t-if="props.metaData.info.noContentHelp" t-call="web.ActionHelper">
                    <t t-set="noContentHelp" t-value="props.metaData.info.noContentHelp"/>
                </t>
                <t t-else="" t-call="web.NoContentHelper"/>
            </t>
        </div>
    </t>

</templates>
